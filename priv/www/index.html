<!doctype html>
<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <title>Chatterbox Demo</title>
    <style>

    body{
	font-size: 17px;
	font-family: arial;
	background: #f4f4f4;
	line-height: 1.5em;
    }

    button{
	background-color: #4CAF50;
	font-size: 12px;
	color: white;
	padding: 14px 20px;
	margin: 8px 0;
	border: none;
	cursor: pointer;
	width: 100%;
    }

    input[type=text]{
	width: 100%;
	padding: 12px 20px;
	margin: 8px 0;
	display: inline-block;
	border: 1px solid #ccc;
	box-sizing: border-box;
    }

    #init{
	padding: 14px;
	width: 50%;
	text-align: center;
    }

    .modal{
	display: none;
	position: fixed;
	z-index: 1;
	left: 0;
	top: 0;
	width: 100%;
	height: 100%;
	overflow: auto;
	background-color: rgb(0,0,0);
	background-color: rgba(0,0,0,0.4);
	padding-top: 60px;
    }

    .modal_content{
	background-color: #fefefe;
	margin: 5% auto 15% auto; // 5% from top, 15% from bottom and centered
	border: 1px solid #888;
	width: 80%;
	padding: 16px;
    }

    </style>
  </head>
  <body>
    <h1>Chatterbox with Mochiweb Demo</h1>

    <div id="init">
      <label>Do you want to join chatterbox?</label><br>
      <button onclick="displayCreateAccount()">Create Account</button><br>
      <label>Already have an account?</label><br>
      <button onclick="displayLogin()">Login</button><br>
    </div>

    <div id="create_account" class="modal" method="post">
      <form id="create_account_form" class="modal_content">
	<label><b>Username</b></label><br>
	<input id="c_name" type="text" placeholder="Enter Username"><br>
	<label><b>Password</b></label><br>
	<input id="c_password" type="text" placeholder="Enter Password"><br>
	<button id="create_account_btn" type="button">Create Account</button>
      </form>
    </div>


    <div id="login" class="modal">
      <form id="login_form" class="modal_content">
	<label>Username</label>
	<input id="l_name" type="text" placeholder="Enter Username">
	<label>Password</label>
	<input id="l_password" type="text"  placeholder="Enter Password"><br>
	<button id="login_btn" type="button">Login</button>
      </form>
    </div>

    <hr/>

    <script >
    var modals = document.getElementsByClassName('modal');

    window.onclick = function(e){
	for (var i = 0; i < modals.length; i++) {
	    if(e.target == modals[i]){
		modals[i].style.display = 'none';
	    }
	}
    }

    function displayCreateAccount(){
	document.getElementById('create_account').style.display = 'block';
    };

    function displayLogin(){
	document.getElementById('login').style.display = 'block';
    };

    $(document).ready(function(){

	$('#create_account_btn').click(function(){
	    var name = document.getElementById("c_name").value;
	    var password = document.getElementById("c_password").value;
	    console.log("username " + name + " password " + password);
	    var formdata = {'name': name,
			    'password': password};

	    console.log('formdata ' + formdata);

	    $.post("account_server create", formdata, function(data){
		var response = JSON.stringify(data);
		console.log("response is " + response);
		
		var caModal = document.getElementById('create_account');
		caModal.style.display = 'none'}, "json");
	});

	$('#login_btn').click(function(){
	    var name = document.getElementById("l_name").value;
	    var password = document.getElementById("l_password").value;
	    console.log("logining.. username " + name + " password " + password);
	    var formdata = {'name': name,
			    'password': password};

	    console.log('formdata ' + formdata);

	    $.post("account_server login", formdata, function(data){
		var response = JSON.stringify(data);
		console.log("response is " + response);

		var caModal = document.getElementById('login');
		caModal.style.display = 'none'}, "json");
	});
	

    });


    </script>
  </body>
</html>
